<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Peta Tanaman â€” Satu Halaman</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-sA+e2XkGkG1w2Lkqgqv+VdM0sKp1Y9w4g1hJ6v9ZZ+M=" crossorigin=""/>
  <style>
    body, html { height:100%; margin:0; font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }
    #map { height: 100vh; width:100%; }
    .legend { background: white; padding: 8px 12px; border-radius:8px; box-shadow:0 1px 6px rgba(0,0,0,0.2); }
    .legend h4 { margin:0 0 6px 0; font-size:14px; }
    .legend-row { display:flex; align-items:center; gap:8px; margin:4px 0; }
    .swatch { width:16px; height:16px; border-radius:4px; }
    .topright { position:absolute; right:12px; top:12px; z-index:1000; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="topright legend" id="legend">
    <h4>Legenda</h4>
    <div class="legend-row"><div class="swatch" style="background:#e41a1c"></div><div>Tanaman 1</div></div>
    <div class="legend-row"><div class="swatch" style="background:#377eb8"></div><div>Tanaman 2</div></div>
    <div class="legend-row"><div class="swatch" style="background:#4daf4a"></div><div>Tanaman 3</div></div>
    <div class="legend-row"><div class="swatch" style="background:#ff7f00"></div><div>Tanaman 4</div></div>
    <div class="legend-row"><div class="swatch" style="background:#984ea3"></div><div>Tanaman 5</div></div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-o9N1j7kM3bWvGk3f6kQ1KQ4nYk0p2bP2f5f5p4R0TGw=" crossorigin=""></script>
  <script>
    // Data titik (lat, lon, label, color)
    const plants = [
      {lat:1.455510, lon:124.828843, name:'Tanaman 1', color:'#e41a1c'},
      {lat:1.455724, lon:124.828812, name:'Tanaman 2', color:'#377eb8'},
      {lat:1.455621, lon:124.828670, name:'Tanaman 3', color:'#4daf4a'},
      {lat:1.455288, lon:124.828405, name:'Tanaman 4', color:'#ff7f00'},
      {lat:1.455763, lon:124.828547, name:'Tanaman 5', color:'#984ea3'}
    ];

    // Hitung pusat peta (rata-rata)
    const avgLat = plants.reduce((s,p)=>s+p.lat,0)/plants.length;
    const avgLon = plants.reduce((s,p)=>s+p.lon,0)/plants.length;

    const map = L.map('map').setView([avgLat, avgLon], 19);

    // OpenStreetMap tile layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 22,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Tambah marker berbentuk circle dengan warna sesuai tanaman
    plants.forEach(p => {
      const circle = L.circleMarker([p.lat, p.lon], {
        radius: 8,
        fillColor: p.color,
        color: '#000000',
        weight: 1,
        opacity: 1,
        fillOpacity: 0.9
      }).addTo(map);

      circle.bindPopup(`<b>${p.name}</b><br/>Lat: ${p.lat}<br/>Lon: ${p.lon}`);
    });

    // Fit bounds sedikit buffer
    const bounds = L.latLngBounds(plants.map(p=>[p.lat,p.lon]));
    map.fitBounds(bounds.pad(0.3));

    // Klik peta untuk menampilkan koordinat (berguna saat verifikasi)
    map.on('click', function(e){
      const c = e.latlng;
      L.popup().setLatLng(c).setContent(`Koordinat: ${c.lat.toFixed(6)}, ${c.lng.toFixed(6)}`).openOn(map);
    });
  </script>
</body>
</html>
